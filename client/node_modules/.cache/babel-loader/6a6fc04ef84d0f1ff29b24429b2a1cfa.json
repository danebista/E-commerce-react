{"ast":null,"code":"import _objectSpread from\"C:/Users/bista/Pictures/e-coomerce-React/e-commerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/bista/Pictures/e-coomerce-React/e-commerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(signInAfterSignUp),_marked13=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpSuccess),_marked14=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from'redux-saga/effects';import{UserActionTypes}from'./user-types';import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.utils';import{SignInSuccess,SignInFailure,signOutSuccess,signOutFailure,signUpSuccess,signUpFailure}from'./user-actions';export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context.sent;user=_yield$auth$signInWit.user;_context.next=7;return getSnapshotFromUserAuth(user);case 7:_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);_context.next=13;return put(SignInFailure(_context.t0));case 13:case\"end\":return _context.stop();}}},_marked,null,[[0,9]]);}export function signInWithEmail(_ref){var _ref$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password;_context2.prev=1;_context2.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context2.sent;user=_yield$auth$signInWit2.user;_context2.next=8;return getSnapshotFromUserAuth(user);case 8:_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);_context2.next=14;return put(SignInFailure(_context2.t0));case 14:case\"end\":return _context2.stop();}}},_marked2,null,[[1,10]]);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context3.stop();}}},_marked3);}export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context5.stop();}}},_marked5);}export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getCurrentUser();case 3:userAuth=_context6.sent;if(userAuth){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context6.next=14;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);_context6.next=14;return put(SignInFailure(_context6.t0));case 14:case\"end\":return _context6.stop();}}},_marked6,null,[[0,10]]);}export function getSnapshotFromUserAuth(userAuth,additionalData){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return call(createUserProfileDocument,userAuth,additionalData);case 3:userRef=_context7.sent;_context7.next=6;return userRef.get();case 6:userSnapshot=_context7.sent;_context7.next=9;return put(SignInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context7.next=15;break;case 11:_context7.prev=11;_context7.t0=_context7[\"catch\"](0);_context7.next=15;return put(SignInFailure(_context7.t0));case 15:case\"end\":return _context7.stop();}}},_marked7,null,[[0,11]]);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return auth.signOut();case 3:_context8.next=5;return put(signOutSuccess());case 5:_context8.next=11;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);_context8.next=11;return put(signOutFailure(_context8.t0));case 11:case\"end\":return _context8.stop();}}},_marked8,null,[[0,7]]);}export function signUp(_ref2){var _ref2$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password,displayName=_ref2$payload.displayName;_context9.prev=1;_context9.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context9.sent;user=_yield$auth$createUse.user;_context9.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context9.next=13;break;case 10:_context9.prev=10;_context9.t0=_context9[\"catch\"](1);put(signUpFailure(_context9.t0));case 13:case\"end\":return _context9.stop();}}},_marked9,null,[[1,10]]);}export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context10.stop();}}},_marked10);}export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context11.stop();}}},_marked11);}export function signInAfterSignUp(_ref3){var _ref3$payload,user,additionalData;return _regeneratorRuntime.wrap(function signInAfterSignUp$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_ref3$payload=_ref3.payload,user=_ref3$payload.user,additionalData=_ref3$payload.additionalData;_context12.next=3;return getSnapshotFromUserAuth(user,additionalData);case 3:case\"end\":return _context12.stop();}}},_marked12);}export function onSignUpSuccess(){return _regeneratorRuntime.wrap(function onSignUpSuccess$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeLatest(UserActionTypes.SIGN_UP_SUCCESS,signInAfterSignUp);case 2:case\"end\":return _context13.stop();}}},_marked13);}export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(isUserAuthenticated),call(onSignOutStart),call(onSignUpStart),call(onSignUpSuccess)]);case 2:case\"end\":return _context14.stop();}}},_marked14);}","map":{"version":3,"sources":["C:/Users/bista/Pictures/e-coomerce-React/e-commerce/client/src/redux/user/user.sagas.js"],"names":["signInWithGoogle","signInWithEmail","onGoogleSignInStart","onEmailSignInStart","onCheckUserSession","isUserAuthenticated","getSnapshotFromUserAuth","signOut","signUp","onSignOutStart","onSignUpStart","signInAfterSignUp","onSignUpSuccess","userSagas","takeLatest","put","all","call","UserActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","SignInSuccess","SignInFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","signInWithPopup","user","payload","email","password","signInWithEmailAndPassword","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","userAuth","additionalData","userRef","get","userSnapshot","id","data","displayName","createUserWithEmailAndPassword","SIGN_OUT_START","SIGN_UP_START","SIGN_UP_SUCCESS"],"mappings":"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","sourcesContent":["import  {takeLatest, put, all, call} from 'redux-saga/effects';\r\nimport {UserActionTypes} from './user-types';\r\nimport {auth, googleProvider, createUserProfileDocument, getCurrentUser} from '../../firebase/firebase.utils';\r\nimport {SignInSuccess, SignInFailure, signOutSuccess, signOutFailure,\r\nsignUpSuccess, signUpFailure} from './user-actions';\r\n\r\nexport function* signInWithGoogle(){\r\n    try{\r\n        const {user} = yield auth.signInWithPopup(googleProvider);\r\n        yield getSnapshotFromUserAuth(user);\r\n    }\r\n    catch(error){\r\n        yield put(SignInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* signInWithEmail({payload:{email, password}}){\r\n    try{\r\n        const {user} = yield auth.signInWithEmailAndPassword(email, password);\r\n        yield getSnapshotFromUserAuth(user);\r\n    }\r\n    catch(error){\r\n        yield put(SignInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* onGoogleSignInStart(){\r\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\r\n}\r\n\r\nexport function* onEmailSignInStart(){\r\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signInWithEmail);\r\n}\r\n\r\nexport function* onCheckUserSession(){\r\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated);\r\n}\r\n\r\nexport function* isUserAuthenticated(){\r\n try{\r\n    const userAuth = yield getCurrentUser();\r\n    if (!userAuth) return;\r\n    yield getSnapshotFromUserAuth(userAuth);\r\n } catch(error){\r\n     yield put(SignInFailure(error))\r\n }   \r\n}\r\nexport function* getSnapshotFromUserAuth(userAuth, additionalData){\r\n    try{\r\n        const userRef = yield call(createUserProfileDocument, userAuth, additionalData);\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(SignInSuccess({id: userSnapshot.id,\r\n        ...userSnapshot.data() }));\r\n    }\r\n    catch(error){\r\n        yield put(SignInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* signOut(){\r\n    try{\r\n        yield auth.signOut();\r\n        yield (put(signOutSuccess()));\r\n    }catch(error){\r\n        yield put(signOutFailure(error));\r\n    }\r\n}\r\n\r\nexport function* signUp({payload:{email, password, displayName}}){\r\n    try{\r\n        const {user} = yield auth.createUserWithEmailAndPassword(\r\n           email, \r\n           password \r\n        );\r\n        yield put(signUpSuccess({user, additionalData: {displayName} }));\r\n\r\n    }catch(error){\r\n        put(signUpFailure(error))\r\n    }\r\n}\r\nexport function* onSignOutStart(){\r\n    yield takeLatest(UserActionTypes.SIGN_OUT_START, signOut)\r\n}\r\n\r\nexport function* onSignUpStart(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_START, signUp)\r\n}\r\n\r\nexport function* signInAfterSignUp({payload:{user, additionalData}}){\r\n    yield getSnapshotFromUserAuth(user, additionalData);\r\n}\r\n\r\nexport function* onSignUpSuccess(){\r\n    yield takeLatest(UserActionTypes.SIGN_UP_SUCCESS, signInAfterSignUp);\r\n}\r\n\r\n\r\nexport function* userSagas(){\r\n    yield all([\r\n        call(onGoogleSignInStart),\r\n        call(onEmailSignInStart),\r\n        call(isUserAuthenticated),\r\n        call(onSignOutStart),\r\n        call(onSignUpStart),\r\n        call(onSignUpSuccess)\r\n    ])\r\n}\r\n"]},"metadata":{},"sourceType":"module"}